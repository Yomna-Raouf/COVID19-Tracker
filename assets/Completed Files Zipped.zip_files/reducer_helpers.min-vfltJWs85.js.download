define(["require","exports","tslib","modules/clean/filepath","modules/clean/react/delorean/util","modules/clean/react/delorean/util","modules/core/i18n","modules/clean/viewer","modules/clean/datetime","modules/clean/react/delorean/data/tooltips","modules/clean/browse_interface","modules/core/uri","modules/clean/react/delorean/data/headings","modules/clean/react/delorean/data/types"],(function(e,t,a,o,n,i,r,d,s,m,l,c,u,_){"use strict";function p(e){var t=e.getTime(),a=s.getTimeBands(Date.now());return t>=a.today?r.intl.formatMessage({id:"JDRaFD",defaultMessage:"Today"}):t>=a.yesterday?r.intl.formatMessage({id:"2iSDDx",defaultMessage:"Yesterday"}):r.intl.formatDate(e,{year:"numeric",month:"short",day:"numeric"})}function f(e){var t=e.eventPath,a=e.user;return void 0===t?void 0:""===t?d.Viewer.get_root_name(a):o.child_dir(t)}Object.defineProperty(t,"__esModule",{value:!0}),o=a.__importStar(o),n=a.__importStar(n),t.getEventCardDate=p,t.createDateBanner=function(e){return{type:_.DeloreanEventType.dateBanner,eventCardDate:p(e),date:n.floorDate(e)}},t.createEmptyDay=function(e){return{type:_.DeloreanEventType.emptyDay,date:e,uid:n.getUid()}},t.getProcessedEvent=function(e){var t=e.event,a=e.path,d=(e.currentFolder,e.user),s=0;if(t.object_metadata)if(n.isMetadataType(t.object_metadata,"single_object_metadata")||n.isMetadataType(t.object_metadata,"multi_object_metadata")||n.isMetadataType(t.object_metadata,"rename_metadata")||n.isMetadataType(t.object_metadata,"move_metadata")||n.isMetadataType(t.object_metadata,"move_in_metadata")||n.isMetadataType(t.object_metadata,"move_out_metadata")||n.isMetadataType(t.object_metadata,"rollback_metadata"))s=t.object_metadata.contents_count||0;else if(n.isMetadataType(t.object_metadata,"edit_metadata"))s=1;else{if(!n.isMetadataType(t.object_metadata,"other"))return i.assertNever(t.object_metadata);s=1}0===s&&(s=1);var g=new Date(t.timestamp_us/1e3),h=null;t.object_metadata&&n.isMetadataType(t.object_metadata,"rollback_metadata")&&0!==t.object_metadata.to_timestamp&&(h=new Date(t.object_metadata.to_timestamp/1e3));var v,y={month:"short",day:"numeric",hour:"numeric",minute:"2-digit"},b=r.intl.formatDate(g,y),M=r.intl.formatDate(g,{weekday:"short",month:"short",day:"numeric"}),D=h?r.intl.formatDate(h,y):null,j=r.intl.formatDate(g,{hour:"numeric",minute:"2-digit"}),T=o.normalize(n.getLocationOfMetadata(t.object_metadata)),w=T+o.normalize(n.getRepresentativeNameOfMetadata(t.object_metadata))===a,P=t.actor.account_id===d.id,z=m.getTooltipForEvent({isYou:P,event:t,itemCount:s,path:a,relativeFolderDisplayPath:""}),E=u.getHeadlineForEvent({event:t,isYou:P,user:d,objectIsCurrentFolder:w,fullRollbackDate:D});v=n.isOpType(t.op_type,"delete")?new c.URI({scheme:"https",authority:"www.dropbox.com",path:"/deleted_files"}):l.browse_uri_for_fq_path(d,T);var F=w?void 0:(function(e){var t=e.event,a=e.user,d=e.path,s=t.object_metadata;if("from_containing_path"in s&&"to_containing_path"in s){var m=f({eventPath:s.from_containing_path,user:a}),l=f({eventPath:s.to_containing_path,user:a});return r.intl.formatMessage({id:"L2sa5J",defaultMessage:"from {src} to {dst}"},{src:m,dst:l})}if("from_containing_path"in s){m=f({eventPath:s.from_containing_path,user:a});return r.intl.formatMessage({id:"sSt7o/",defaultMessage:"from {location}"},{location:m})}if("to_containing_path"in s){l=f({eventPath:s.to_containing_path,user:a});return o.normalize(s.to_containing_path)!==o.normalize(d)?r.intl.formatMessage({id:"/0++y2",defaultMessage:"to {location}"},{location:l}):void 0}if("containing_path"in s){var c=f({eventPath:s.containing_path,user:a});return""===o.normalize(s.containing_path)&&"name"in s&&""===s.name?void 0:o.normalize(s.containing_path)!==o.normalize(d)?r.intl.formatMessage({id:"N9Moi6",defaultMessage:"in {location}"},{location:c}):void 0}if(!n.isMetadataType(s,"other"))return i.assertNever(s)})({event:t,user:d,path:a});return{type:_.DeloreanEventType.event,actor:t.actor,count:s,browseHref:v,eventCardDate:p(g),confirmationCardDate:b,formattedDate:M,date:g,tooltip:z,uid:i.getUid(),eventHeadline:E,timestamp:g.getTime(),displayTooltip:z!==E,cardSubheading:F,operationName:n.getNameOfOpType(t.op_type),timeAgo:j}},t.getRootFolderName=function(e,t){return"personal"===e.role?t.is_paired?r.intl.formatMessage({id:"QPBzI3",defaultMessage:"Personal"}):r.intl.formatMessage({id:"rIir19",defaultMessage:"Dropbox"}):t.team_name},t.checkHasDataThisWeek=function(e,t,a){return e.slice(e.length-t,e.length-a).reduce((function(e,t){return e+t.count}),0)>0}}));
//# sourceMappingURL=reducer_helpers.min.js-vfl8XUpwV.map