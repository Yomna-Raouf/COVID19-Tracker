define(["require","exports","tslib","react","modules/core/i18n","modules/clean/react/delorean/data/types","modules/clean/react/delorean/components/folder_history/folder_history","modules/clean/react/delorean/data/actions","modules/clean/react/delorean/components/rewind_step_header","modules/clean/react/delorean/components/rewind_continue_widget","modules/clean/react/trash/constants","modules/clean/react/delorean/logging","modules/clean/react/delorean/constants","modules/clean/react/delorean/util"],(function(e,t,s,n,o,r,i,a,d,p,c,l,u,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=s.__importDefault(n),l=s.__importStar(l);var h=(function(e){function t(t){var n=e.call(this,t)||this;return n.initialEventTimestamp=null,n.startLoadTsInMs=null,n.loadPageOfEvents=function(){var e=n.props,t=e.user,o=e.restoreId,i=e.events;n.setState((function(e){var a=e.pagesLoaded+1;if(2===a&&(l.loadEvents({user:t,restoreId:o,startLoadTsInMs:n.startLoadTsInMs,events:i}),n.props.events.type===r.RewindEventState.hasContent))for(var d=0,p=n.props.events.processedEvents;d<p.length;d++){var c=p[d];if(c.type===r.DeloreanEventType.event){n.initialEventTimestamp=c.timestamp;break}}return s.__assign(s.__assign({},e),{pagesLoaded:a})}))},n.onGoBack=function(){var e=n.props,t=e.user,s=e.restoreId;l.clickEventsBack({user:t,restoreId:s}),n.props.dispatch({type:r.DeloreanActionType.goBackFromActivityListPage})},n.showMoreFuture=function(e){var t=Date.now();n.props.dispatch(a.showMoreAction({user:n.props.user,fqpath:n.props.browseContext.currentFQPath,futureCursor:e,direction:r.PaginationDirection.future,done:function(e){var s=n.props,o=s.user,r=s.restoreId;l.clickEventsLoadNew({user:o,restoreId:r,startTsInMs:t,count:e})}}))},n.showMorePast=function(e){var t=Date.now();n.props.dispatch(a.showMoreAction({user:n.props.user,fqpath:n.props.browseContext.currentFQPath,pastCursor:e,direction:r.PaginationDirection.past,done:function(e){var s=n.props,o=s.user,r=s.restoreId;l.clickEventsLoadNew({user:o,restoreId:r,startTsInMs:t,count:e})}}))},n.selectEventForRewind=function(e){n.setState({eventAboveDivider:e.topEvent})},n.onContinue=function(){n.state.eventAboveDivider&&(n.logContinue(n.state.eventAboveDivider),n.props.dispatch({type:r.DeloreanActionType.changeRewindPageToConfirmationPage,eventAboveDivider:n.state.eventAboveDivider}))},n.logContinue=function(e){if(n.props.events.type===r.RewindEventState.hasContent){var t=n.initialEventTimestamp,s=n.props,o=s.user,i=s.restoreId,a=n.props.events.processedEvents;l.clickEventsNext({selectedEvent:e,events:a,restoreId:i,initialEventTimestamp:t,user:o})}},n.state={pagesLoaded:0,eventAboveDivider:void 0},n}return s.__extends(t,e),t.prototype.componentDidMount=function(){this.startLoadTsInMs=Date.now(),this.props.dispatch({type:r.DeloreanActionType.clearEventList});var e=Math.floor((this.props.selectedDateTsInMs+c.ONE_DAY_MS)/1e3);this.props.dispatch(a.fetchEventsAction({user:this.props.user,fqpath:this.props.fqpath,onlyRewindableEvents:this.props.isForRewindFlow,direction:r.PaginationDirection.past,timestampInSeconds:e,done:this.loadPageOfEvents})),this.props.dispatch(a.fetchEventsAction({user:this.props.user,fqpath:this.props.fqpath,direction:r.PaginationDirection.future,onlyRewindableEvents:this.props.isForRewindFlow,timestampInSeconds:e,done:this.loadPageOfEvents}))},t.prototype.render=function(){return n.default.createElement("div",{className:"folder-history-ie11fix"},n.default.createElement("div",{className:"folder-history-event-list-container"},this.props.isForRewindFlow&&n.default.createElement(d.RewindStepHeader,{currentStep:2,maxStep:u.NUM_REWIND_STEPS,instructions:o.intl.formatMessage({id:"nfkI3y",defaultMessage:"Fine tune"}),onGoBack:this.onGoBack}),n.default.createElement(i.FolderHistory,{selectedDateTsInMs:this.props.selectedDateTsInMs,dispatch:this.props.dispatch,events:this.props.events,isForARewind:this.props.isForRewindFlow,onShowMoreFuture:this.showMoreFuture,onShowMorePast:this.showMorePast,onClickEvent:this.props.isForRewindFlow?this.selectEventForRewind:v.noop,pagesLoaded:this.state.pagesLoaded}),n.default.createElement(p.RewindContinueWidget,{onContinue:this.onContinue,visible:!!this.state.eventAboveDivider,text:o.intl.formatMessage({id:"BRqDy1",defaultMessage:"Now, letâ€™s review"})})))},t})(n.default.Component);t.RewindActivityListPage=h}));
//# sourceMappingURL=rewind_activity_list_page.min.js-vflQaO2HA.map