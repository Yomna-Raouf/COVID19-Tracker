define(["require","exports","tslib","react","modules/core/browser","modules/core/i18n","modules/clean/react/delorean/data/api","modules/clean/react/image","modules/clean/static_urls","modules/clean/react/delorean/data/types","modules/clean/react/delorean/constants","modules/clean/react/snackbar","modules/clean/react/delorean/logging","modules/clean/react/delorean/util"],(function(e,t,a,o,r,s,n,i,l,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=a.__importDefault(o),r=a.__importStar(r),n=a.__importStar(n),p=a.__importStar(p);var g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clickContactSupport=function(){r.open_tab("https://www.dropbox.com/support")},t.navigateToHelp=function(e){var a=t.props,o=a.user,s=a.restoreId;p.clickHelp({user:o,restoreId:s,helpStep:e}),r.unsafe_open_tab("https://help.dropbox.com/security/rewind#after")},t.goToHelpProgressPage=function(){t.navigateToHelp(p.DeloreanPage.progress)},t.goToHelpCompletionPage=function(){t.navigateToHelp(p.DeloreanPage.completion)},t}return a.__extends(t,e),t.prototype.showSuccess=function(e){var t=this.props,a=t.user,o=t.restoreId;this.props.dispatch({type:d.DeloreanActionType.setRewindComplete}),p.loadCompletionSuccess({user:a,restoreId:o,startTs:e})},t.prototype.showFailure=function(e){var t=this.props,a=t.user,r=t.restoreId;p.loadCompletionFailure({user:a,restoreId:r,startTs:e}),u.Snackbar.show(o.default.createElement(u.Snackbar,{closeButtonText:s.intl.formatMessage({id:"u/p3Pl",defaultMessage:"Close"}),actionButtonText:s.intl.formatMessage({id:"SDLkWB",defaultMessage:"Contact us"}),onActionClick:this.clickContactSupport,title:s.intl.formatMessage({id:"EKgeAS",defaultMessage:"Couldn’t rewind this folder. Try again or let us help"}),variant:"fail"})),this.props.closePanel({closedByClick:!1})},t.prototype.componentDidMount=function(){var e=this,t=this.props,o=t.user,r=t.restoreId,s=Date.now();this.props.dispatch({type:d.DeloreanActionType.setRewindInProgress}),p.loadProgress({user:o,restoreId:r});var i=setInterval((function(){return a.__awaiter(e,void 0,void 0,(function(){var e;return a.__generator(this,(function(t){switch(t.label){case 0:return[4,n.getRewindStatus({id:this.props.page.rewindId,user:this.props.user})];case 1:return"successful"===(e=t.sent()).status[".tag"]&&(clearInterval(i),this.showSuccess(s)),"failed"===e.status[".tag"]&&(clearInterval(i),this.showFailure(s)),[2]}}))}))}),c.LOADING_PAGE_POLLING_LENGTH_MS)},t.prototype.render=function(){return this.props.rewindState===d.RewindState.Done?o.default.createElement(h,{page:this.props.page,goToHelpCompletionPage:this.goToHelpCompletionPage}):this.props.rewindState===d.RewindState.InProgress?o.default.createElement(f,{page:this.props.page,goToHelpProgressPage:this.goToHelpProgressPage,folderName:this.props.folderName}):m.assertNever(this.props.rewindState)},t})(o.default.Component);t.RewindStarted=g;var f=function(e){return o.default.createElement("div",{className:"rewind-text"},o.default.createElement(i.Image,{className:"rewind-loading-img",src:l.static_url("/static/images/dbx_cloud_doc_loading-vfl9ZK2NS.gif"),alt:""}),o.default.createElement("div",{className:"rewind-confirmation-header"},s.intl.formatMessage({id:"on0Nju",defaultMessage:"Rewinding to an earlier time…"},{folder_name:e.folderName})),o.default.createElement("div",{className:"rewind-confirmation-text"},o.default.createElement("div",null,s.intl.formatMessage({id:"bDOcv2",defaultMessage:"Everything will soon be like it was before {date} at {time}. Don’t make any changes here until it’s done."},{date:e.page.selectedEvent.formattedDate,time:e.page.selectedEvent.timeAgo})),o.default.createElement("a",{href:"#",onClick:e.goToHelpProgressPage},s.intl.formatMessage({id:"sGoZLi",defaultMessage:"What to do after rewinding"}))))},h=function(e){return o.default.createElement("div",{className:"rewind-text"},o.default.createElement(i.Image,{className:"rewind-finished-img",src:l.static_url("/static/images/delorean/illo-rewind-complete@1x-vflVS_j1t.png"),alt:""}),o.default.createElement("div",{className:"rewind-confirmation-header"},s.intl.formatMessage({id:"zJta6Y",defaultMessage:"Welcome back to {date} at {time}"},{date:e.page.selectedEvent.formattedDate,time:e.page.selectedEvent.timeAgo})),o.default.createElement("div",{className:"rewind-confirmation-text"},s.intl.formatMessage({id:"vXeDf5",defaultMessage:"You can use dropbox.com now, but wait for your devices to finish syncing. If anything doesn’t look like you expected, <options>learn more about your options</options>"},{div:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.default.createElement("div",null,e)},options:function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];return o.default.createElement("a",{href:"#",onClick:e.goToHelpCompletionPage},t)}})))}}));
//# sourceMappingURL=rewind_started.min.js-vflp44eza.map